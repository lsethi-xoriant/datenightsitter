<script>
  var BRAINTREE_PAYMENT_CSE = "<%= Rails.application.secrets.braintree_cse %>"
</script>
<style>
    .settle_up-review {
      font-size: 16px;
    }
    
    .settle_up-review .amount {
      font-size: 32px;
    }
    .settle_up-review #transaction_amount {
      width: 70px;
      text-align: center;
    }
    
    .settle_up-review #credit_card {
      width: 150px;
    }
    
    .settle_up-review #cvv {
      width: 75px;
    }
    
    .settle_up-review #zipcode {
      width: 75px;
    }
    
    .settle_up-review #email {
      width: 275px;
    }
    
    .thin-divider {
      margin-top: 2px;
      margin-bottom: 2px;
    }
    
    .row-amount {
      
    }
    
</style>
<div class='col-xs-12 col-sm-6 col-sm-offset-3 col-lg-4 col-lg-offset-4 settle_up-review' style="padding-left: 0px; padding-right: 0px; font-size: 12px;">
  <h3 style="margin-top: 0px;">Settle-up with <%= @trans.provider.first_name.titleize %> </h3>

  <p>Hi <%= @trans.seeker.last_name.titleize %> family,
  <%= @trans.provider.first_name.titleize %> is using Sittercity Payments and it saves you a trip to the ATM.  It's easy:
  </p>


  <%=  form_tag(settle_up_path(@trans), :method => :put, :class => "form-inline", :id => "braintree-payment-form") do %>
    <%= simple_fields_for @trans, :class => "form-inline" do |f| %>
    <div class="form-group row row-amount">
      <div class="col-xs-6">
        <span><%= f.label :amount, "Pay" %></span>&nbsp;&nbsp;
          <span class='amount'>$<%= f.input_field :amount, :value => number_with_precision(f.object.amount, precision: 0) %></span>
      </div>
      <div class="col-xs-6">
          <button id='round-up' type='button' data-amount='<%=@round_up %>' class="btn btn-info btn-sm btn-round-up">
            Round up to $<%=@round_up %>
          </button>
        <hr class="thin-divider">
        <button id='bump-up' type='button' data-amount='<%=@bump %>' class="btn btn-info btn-sm btn-round-up">
          Add an extra $<%=@bump %>
        </button>
      </div>
    </div>
    <% end %>
    <div class="col-xs-12">
      <hr class="thin-divider">
      start: <%= @trans.started_at.strftime('%m/%d @ %l:%M%P %Z') %> | duration: <%= number_with_precision(@trans.duration, :precision => 2) %> hrs<br/>
      ** Don't forget any expenses and travel home **
      <hr class="thin-divider">
    </div>
    <h4>Credit card details</h4>
    <div class="form-group row">
      <div class="col-xs-8">
        <%= label_tag(:credit_card, "Credit Card") %>
        <%= text_field_tag(:card, nil, :data => {:encrypted_name => "number"}, :required => true, :maxlength => 16, :hint => "3722111122223333") %>
      </div>
      <div class="col-xs-4">
        <%= label_tag(:cvv, "CVV") %>
        <%= text_field_tag(:cvv, nil, :data => {:encrypted_name => "cvv"}, :required => true, :maxlength => 4) %>
      </div>
    </div>
    <%= simple_fields_for @trans.seeker, :class => "form-inline" do |f| %>
    <div class="form-group row">
      <div class="col-xs-8">
        <%= label_tag(:date, "Expiration Date") %></br>
        <%= select_month(Time.now, { }, { :data => {:encrypted_name => "month"} })  %> / 
        <%= select_year(Date.today.next_year,
                        {:start_year => Date.today.year },
                        { :data => {:encrypted_name => "year"}})  %>
      </div>
      <div class="col-xs-4">
        <%= f.label :zip, "Zip Code" %>
        <%= f.input_field :zip, :required => true, :maxlength => 5 %>
      </div>
    </div>
    <div class="form-group row">
      <div class="col-xs-12">
        <%= f.label :email, "Email Address" %> (so we can send you a receipt)
        <%= f.input_field :email, :required => true, :maxlength => 50 %>
      </div>
    </div>
    <% end %>
    <div class="row-fluid">
      <div class="col-xs-6 col-xs-offset-3">
        <%= submit_tag("Send to #{@trans.provider.first_name.titleize}", :class=>"btn btn-primary") %>
      </div>
    </div>
  <% end %>
  
</div>
